<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Government Shutdown Conversation</title>
<style>
  :root {
    --bg:#f6f7fb; --card:#fff; --muted:#6b7280; --accent:#1f6feb;
    --radius:12px; --shadow:0 6px 18px rgba(35,40,50,0.08);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  body { background:var(--bg); margin:20px; color:#111; }
  .container { max-width:820px; margin:0 auto; }
  .conversation { display:flex; flex-direction:column; gap:12px; margin-bottom:12px; }
  .post {
    background:var(--card); border-radius:var(--radius); padding:12px;
    display:flex; gap:12px; align-items:flex-start; box-shadow:var(--shadow);
    border-bottom:1px solid #f1f5f9; position:relative;
  }
  .post:hover { transform:translateY(-2px); transition:transform .15s ease; }
  .avatar { width:48px; height:48px; border-radius:50%; flex:0 0 48px; display:grid; place-items:center; color:#fff; font-weight:700; font-size:14px; }
  .g1{background:linear-gradient(135deg,#1f6feb,#3b82f6);}
  .g2{background:linear-gradient(135deg,#10b981,#34d399);}
  .g3{background:linear-gradient(135deg,#f59e0b,#fbbf24);}
  .g4{background:linear-gradient(135deg,#ec4899,#f472b6);}
  .content{flex:1;}
  .meta{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted);}
  .name{font-weight:700;color:#0f1724;margin-right:4px;}
  .handle{color:var(--muted);}
  .text{margin-top:6px;font-size:15px;line-height:1.45;color:#0f1724;white-space:pre-wrap;}
  .actions{margin-top:10px;display:flex;gap:14px;color:var(--muted);font-size:13px;}
  .actions button{background:none;border:none;cursor:pointer;padding:4px 6px;border-radius:6px;}
  .actions button:hover{background:#f1f5f9;transform:scale(1.08);}
  #showMore{display:block;margin:8px auto 12px auto;padding:8px 14px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer;font-weight:500;}
  #showMore.fade-out{animation:fadeOut .25s forwards;}
  .fade-in{animation:fadeInUp .36s ease forwards;}
  @keyframes fadeInUp{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:none;}}
  @keyframes fadeOut{from{opacity:1;}to{opacity:0;transform:scale(.98);}}
  .reply-box{margin-top:12px;display:flex;gap:10px;align-items:flex-end;}
  textarea{flex:1;min-height:78px;padding:10px;border-radius:8px;border:1px solid #e2e8f0;font-size:14px;resize:vertical;}
  .post-btn{padding:8px 14px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer;}
  .post-btn:hover{background:#155bd8;}
</style>
</head>
<body>
<div class="container">
  <h2>Conversation</h2>
  <div id="conversation" class="conversation" aria-live="polite"></div>
  <button id="showMore">Show more comments</button>
  <div class="reply-box">
    <textarea id="userComment" placeholder="Write a reply..."></textarea>
    <button id="postComment" class="post-btn">Post</button>
  </div>
</div>

<script>
const initialPosts = [
  { id:"p1", name:"Office of Congressman Abe Hamadeh", handle:"@RepAbeHamadeh", avatarSeed:"AH", text:"This government shutdown is entirely on the Democrats‚ÄîSenate Democrats and House Democrats egging them on. The Republicans have no reason to budge. This was a clean CR. The radical left is the one shutting down the government because they want to give healthcare to illegal immigrants.", likes:50, retweets:10 },
  { id:"p2", name:"Elaine", handle:"@ElaineAZ", avatarSeed:"E", text:"Where does the 20 billion for Argentinian bail out come in? Republicans are a waste of government money.", likes:5, retweets:1 },
  { id:"p3", name:"Angry Arizonans", handle:"@AngryAZ", avatarSeed:"AA", text:"Hold the line. We don't negotiate with terrorists.", likes:8, retweets:2 },
  { id:"p4", name:"DennyZ", handle:"@DennyZ", avatarSeed:"DZ", text:"‚ÄúClean CR‚Äù filled with the waste & fraud that @doge found, AND funding for USAID and PBS. That‚Äôs ‚Äúclean‚Äù? @SpeakerJohnson‚Äôs talking points. Sad.", likes:4, retweets:0 },
  { id:"p5", name:"Sally_P", handle:"@sally_politico", avatarSeed:"SP", text:"Shutdowns always hurt working families while politicians still get paid. Both sides should compromise for once.", likes:6, retweets:1 }
];

const morePosts = [
  { id:"p6", name:"CivicWatcher", handle:"@CivicWatcher", avatarSeed:"CW", text:"The cost of these shutdowns is enormous‚Äîbillions wasted just restarting agencies. Totally avoidable.", likes:3, retweets:1 },
  { id:"p7", name:"MikeTX", handle:"@MikeTX", avatarSeed:"MT", text:"Every shutdown is the same story. Performative politics and zero accountability.", likes:2, retweets:0 },
  { id:"p8", name:"AZPolicyNerd", handle:"@AZPolicyNerd", avatarSeed:"AP", text:"Interesting how 'clean' becomes subjective. The CRs always carry some hidden riders.", likes:5, retweets:2 },
  { id:"p9", name:"Marcy", handle:"@Marcy2024", avatarSeed:"M", text:"Both parties are just playing chicken with people's livelihoods.", likes:4, retweets:1 }
];

let appendedMore=false, likeCounts={}, retweetCounts={};

function initials(seed){const s=String(seed).trim().split(/\s+/);return s.length>1?s[0][0]+s[1][0]:String(seed).slice(0,2).toUpperCase();}
function seedToAvatarClass(seed){let s=0;for(let c of String(seed))s+=c.charCodeAt(0);return["g1","g2","g3","g4"][s%4];}

const convo=document.getElementById("conversation");

function renderInitial(){
  convo.innerHTML="";
  initialPosts.forEach(p=>convo.appendChild(createPost(p)));
}
function createPost(p){
  const wrap=document.createElement("article");wrap.className="post fade-in";wrap.id=`post-${p.id}`;
  const av=document.createElement("div");av.className="avatar "+seedToAvatarClass(p.avatarSeed||p.name||p.id);av.textContent=initials(p.avatarSeed||p.name||p.id);
  const cont=document.createElement("div");cont.className="content";
  const meta=document.createElement("div");meta.className="meta";
  const nm=document.createElement("span");nm.className="name";nm.textContent=p.name;
  const hd=document.createElement("span");hd.className="handle";hd.textContent=" "+p.handle;
  meta.append(nm,hd);
  const txt=document.createElement("div");txt.className="text";txt.textContent=p.text;
  const act=document.createElement("div");act.className="actions";
  const like=document.createElement("button");like.innerHTML=`‚ù§Ô∏è <span class="count">${p.likes||0}</span>`;
  like.onclick=()=>{likeCounts[p.id]=(likeCounts[p.id]??p.likes??0)+1;like.querySelector(".count").textContent=likeCounts[p.id];window.parent.postMessage({type:"USER_LIKE",postId:p.id},"*");};
  const rt=document.createElement("button");rt.innerHTML=`üîÅ <span class="count">${p.retweets||0}</span>`;
  rt.onclick=()=>{retweetCounts[p.id]=(retweetCounts[p.id]??p.retweets??0)+1;rt.querySelector(".count").textContent=retweetCounts[p.id];window.parent.postMessage({type:"USER_RETWEET",postId:p.id},"*");};
  act.append(like,rt);cont.append(meta,txt,act);wrap.append(av,cont);return wrap;
}

document.getElementById("showMore").onclick=e=>{
  if(appendedMore)return;appendedMore=true;
  morePosts.forEach(p=>convo.appendChild(createPost(p)));
  e.target.classList.add("fade-out");setTimeout(()=>e.target.style.display="none",260);
  window.parent.postMessage({type:"USER_SHOW_MORE_CLICKED"},"*");
  sendHeight();
};

document.getElementById("postComment").onclick=()=>{
  const ta=document.getElementById("userComment"),txt=ta.value.trim();
  if(!txt)return alert("Please write something before posting.");
  const newPost={id:"u"+Date.now(),name:"You",handle:"@you",avatarSeed:"YOU",text:txt,likes:0,retweets:0};
  convo.appendChild(createPost(newPost));ta.value="";
  window.parent.postMessage({type:"USER_COMMENT",data:txt},"*");sendHeight();
};

function sendHeight(){if(window.parent!==window)window.parent.postMessage({type:"IFRAME_HEIGHT",height:document.body.scrollHeight},"*");}

renderInitial();sendHeight();new MutationObserver(sendHeight).observe(convo,{childList:true,subtree:true});
</script>
</body>
</html>
